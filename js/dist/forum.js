(()=>{var e={n:o=>{var n=o&&o.__esModule?()=>o.default:()=>o;return e.d(n,{a:n}),n},d:(o,n)=>{for(var t in n)e.o(n,t)&&!e.o(o,t)&&Object.defineProperty(o,t,{enumerable:!0,get:n[t]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o)};(()=>{"use strict";function o(){return o=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var n=arguments[o];for(var t in n)({}).hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},o.apply(null,arguments)}const n=flarum.core.compat["common/extend"],t=flarum.core.compat["forum/app"];var r=e.n(t);const i=flarum.core.compat["common/components/TextEditor"];var a=e.n(i);const s=flarum.core.compat["common/components/TextEditorButton"];var c=e.n(s),l="clarkwinkelmann-emojionearea.forum.",u=!1;r().initializers.add("clarkwinkelmann-emojionearea",(function(){a().prototype.emojioneAreaClickedOutside=function(e){if(this.emojioneArea&&this.emojioneArea.isReady){var o=$(e.target);o.is(".emojionearea")||o.parents(".emojionearea").length||o.parents(".Button-emojionearea").length||this.emojioneArea.hidePicker()}},a().prototype.configureEmojioneArea=function(){var e=this;if(this.emojioneArea)return Promise.resolve();var n=$('<div class="ComposerBody-emojioneareaContainer"/>');return this.$(".TextEditor-controls").before(n),new Promise((function(t){var i={};Object.keys($().emojioneArea.defaults.filters).forEach((function(e){var o=l+"filters."+e;o in r().translator.translations&&(i[e]={title:r().translator.trans(o)})}));var a=$("<div />").emojioneArea(o({standalone:!0,sprite:!1,hidePickerOnBlur:!1,searchPlaceholder:r().translator.trans(l+"search_placeholder"),buttonTitle:r().translator.trans(l+"picker_button"),container:n,filters:i,events:{emojibtn_click:function(){e.attrs.composer.editor.insertAtCursor(e.emojioneArea.getText()),r().forum.attribute("emojioneAreaCloseOnPick")&&e.emojioneArea.hidePicker()},ready:t}},r().forum.attribute("emojioneAreaConfig")));e.emojioneArea=a.data("emojioneArea")}))},(0,n.extend)(a().prototype,"oncreate",(function(){this.emojioneArea=null,this.emojioneAreaLoading=!1,document.addEventListener("click",this.emojioneAreaClickedOutside.bind(this))})),(0,n.extend)(a().prototype,"onremove",(function(){document.removeEventListener("click",this.emojioneAreaClickedOutside)})),(0,n.extend)(a().prototype,"toolbarItems",(function(e){var o=this;e.add("clarkwinkelmann-emojionearea",c().component({onclick:function(){o.emojioneAreaLoading||(o.emojioneArea&&o.emojioneArea.button.is(".active")?o.emojioneArea.hidePicker():(o.emojioneAreaLoading=!0,(u?Promise.resolve():(u=!0,new Promise((function(e){var o=document.createElement("link");o.rel="stylesheet",o.crossOrigin="anonymous",o.integrity="sha256-LKawN9UgfpZuYSE2HiCxxDxDgLOVDx2R4ogilBI52oc=",o.href="https://cdn.jsdelivr.net/npm/emojionearea@3.4.2/dist/emojionearea.min.css",document.head.appendChild(o);var n=document.createElement("script");n.crossOrigin="anonymous",n.integrity="sha256-ImIFrmJd7ymGlVw2MbtI96BNPW4NfcKqM3d1Go665Ig=",n.src="https://cdn.jsdelivr.net/npm/emojionearea@3.4.2/dist/emojionearea.min.js",n.onload=e,document.body.appendChild(n)})))).then((function(){o.configureEmojioneArea().then((function(){var e=o.$(".Button-emojionearea").position();o.$(".emojionearea-picker").css("left",e.left-290),o.emojioneArea.showPicker(),$(".emojionearea-search input").focus(),o.emojioneAreaLoading=!1,m.redraw()}))}))))},className:"Button Button--icon Button--link Button-emojionearea",icon:this.emojioneAreaLoading?"fas fa-spinner fa-pulse":"far fa-smile-beam",title:r().translator.trans(l+"picker_button")}))}))})),r().initializers.add("clarkwinkelmann-emojionearea-after",(function(){(0,n.extend)(a().prototype,"toolbarItems",(function(e){r().forum.attribute("emojioneAreaHideFlarumButton")&&e.has("emoji")&&e.remove("emoji")}))}),-100)})(),module.exports={}})();
//# sourceMappingURL=forum.js.map